"use strict";(self.webpackChunkinstagram_clone=self.webpackChunkinstagram_clone||[]).push([[512],{3512:function(e,t,s){s.r(t),s.d(t,{default:function(){return B}});var n=s(2791),r=s(4968),l=s(1413),o=s(2982),c=s(5861),a=s(885),i=s(7757),u=s.n(i),d=s(9688),f=s(83),m=s(9329),x=s(6724),h=function(e,t){return Math.floor(Math.random()*(t-e))+e},p=s(3504),g=s(6871),j=s(1743),w=s(6727),v=s(1273),b=s(4219),I=s(184),y=n.memo((function(e){var t=e.profileImage,s=e.username,r=e.fullName,l=e.userId,o=e.isFollowing,c=(0,j.C)((function(e){return e.signedUser.user})),i=(0,g.s0)(),u=(0,n.useState)(!1),d=(0,a.Z)(u,2),m=d[0],x=d[1],h=(0,w.Z)({userId:l}),p=h.addToFollowing,y=h.removeFromFollowing;return(0,I.jsxs)("div",{className:"flex w-full h-8 mb-1 justify-between items-center my-[4px]",children:[(0,I.jsxs)("button",{className:"w-full h-full py-[0.5px] gap-2 flex items-center",onClick:function(){return i(f.Z.DASHBOARD+l)},children:[(0,I.jsx)("img",{src:t.length?t:"/instagram-clone/images/default-avatar-gray.jpg",className:"h-8 w-8 rounded-full object-cover"}),(0,I.jsxs)("div",{className:"flex flex-col items-start",children:[(0,I.jsx)("p",{className:"font-medium text-sm tracking-wide whitespace-nowrap",children:s}),(0,I.jsx)("p",{className:"text-gray-400 text-sm whitespace-nowrap",children:o?"Follows you":r})]})]}),c.following.some((function(e){return e.userId===l}))?(0,I.jsx)("button",{className:"rounded text-gray-800 text-sm font-medium cursor-pointer",onClick:function(e){e.stopPropagation(),x(!0)},children:"Following"}):(0,I.jsx)("button",{className:"font-medium text-cyan-500 rounded cursor-pointer text-sm tracking-wide",onClick:function(e){e.stopPropagation(),p()},children:"Follow"}),m?(0,I.jsx)(v.Z,{closeEvent:function(){return x(!1)},styles:"h-72 top-[26.5%]",children:(0,I.jsx)(b.Z,{areYouSureEvent:function(){x(!1),y()},profileImage:t,closeEvent:function(){return x(!1)},questionText:"Unfollow ".concat(s),buttonText:"Unfollow"})}):null]})})),N=n.memo((function(){var e=(0,j.C)((function(e){return e.signedUser.user})),t=(0,n.useState)([]),s=(0,a.Z)(t,2),r=s[0],i=s[1],w=(0,g.s0)();(0,n.useEffect)((function(){var t=function(){var t=(0,c.Z)(u().mark((function t(){var s,n,r,l,c;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=(0,x.hJ)(m.db,"users"),n=(0,x.IO)(s,(0,x.ar)("username",">=","")),t.next=4,(0,x.PL)(n);case 4:for(r=t.sent,l=[],c=function(){var t=h(0,r.docs.length),s=r.docs[t].data();l.every((function(e){return e.userId!==s.userId}))&&e.following.every((function(e){return e.userId!==s.userId}))&&s.userId!==e.userId&&(i((function(e){return[].concat((0,o.Z)(e),[s])})),l=[].concat((0,o.Z)(l),[s]))};5!==l.length;)c();case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();t()}),[]);var v=(0,n.useMemo)((function(){return r.map((function(t){return(0,n.createElement)(y,(0,l.Z)((0,l.Z)({},t),{},{key:t.userId,isFollowing:t.following.some((function(t){return t.userId===e.userId}))}))}))}),[r]);return(0,I.jsxs)("aside",{className:"flex flex-col gap-4 w-[325px]",children:[(0,I.jsxs)("div",{className:"flex w-full h-13 mb-1 px-3 justify-between items-center my-[4px]",children:[(0,I.jsxs)("button",{className:"w-full h-full py-[0.5px] gap-2 flex items-center",onClick:function(){return w(f.Z.DASHBOARD+e.userId)},children:[(0,I.jsx)("img",{src:e.profileImage.length?e.profileImage:"/instagram-clone/images/default-avatar-gray.jpg",className:"h-11 w-11 rounded-full object-cover"}),(0,I.jsxs)("div",{className:"flex flex-col items-start",children:[(0,I.jsx)("p",{className:"font-medium text-sm tracking-wide whitespace-nowrap",children:e.username}),(0,I.jsx)("p",{className:"text-gray-400 text-sm whitespace-nowrap",children:e.fullName})]})]}),(0,I.jsx)("button",{className:"h-7 rounded text-cyan-500 text-sm font-medium cursor-pointer",children:"Switch"})]}),(0,I.jsxs)("div",{className:"flex w-full justify-between px-3",children:[(0,I.jsx)("p",{className:"text-gray-500 font-medium text-sm",children:"Suggestions For You"}),(0,I.jsx)(p.rU,{className:"text-sm font-medium",to:f.Z.PEOPLE,children:"See All"})]}),(0,I.jsx)("div",{className:"flex flex-col gap-2 px-3",children:5===v.length?v:function(){for(var e=[],t=0;t<5;t++)e.push((0,I.jsx)(d.Z,{imageStyles:{width:32,height:32,borderRadius:"50%"},firstTextStyles:{width:120,height:7,borderRadius:"10px"},secondTextStyles:{width:80,height:7,borderRadius:"10px"},margin:"ml-[-13px]"},t));return e}()}),(0,I.jsxs)("div",{className:"flex flex-col gap-4 text-xs text-gray-300 px-3",children:[(0,I.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,I.jsx)("p",{children:"About"}),(0,I.jsx)("p",{children:"Help"}),(0,I.jsx)("p",{children:"Press"}),(0,I.jsx)("p",{children:"API"}),(0,I.jsx)("p",{children:"Jobs"}),(0,I.jsx)("p",{children:"Privacy"}),(0,I.jsx)("p",{children:"Terms"}),(0,I.jsx)("p",{children:"Location"}),(0,I.jsx)("p",{children:"Language"})]}),(0,I.jsx)("p",{className:"text-xs text-gray-300",children:"\xa9 2022 INSTAGRAM FROM META"})]})]})})),Z=N,k=s(7018),S=s(2659),A=s(1518),C=s(8767),P=s(9110),R=s(4140),E=s(5368),T=n.memo((function(e){var t=e.closeEvent,s=e.post,r=(0,g.s0)(),l=(0,w.Z)({userId:s.fromId}).removeFromFollowing,o=(0,n.useState)(!1),c=(0,a.Z)(o,2),i=c[0],u=c[1];return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsxs)("div",{className:"h-full w-full flex flex-col items-center",children:[(0,I.jsx)("button",{className:"w-full active:bg-gray-300 h-12 flex items-center justify-center text-rose-600 font-medium text-sm rounded-t-xl",onClick:function(){l(),t()},children:"Unfollow"}),(0,I.jsx)("button",{className:"w-full active:bg-gray-300 h-12 border-t-2 flex items-center justify-center text-sm",onClick:function(){return r(f.Z.DASHBOARD+s.fromId+"/"+P.Z.POST+s.postId)},children:"Go to post"}),(0,I.jsx)("button",{className:"w-full active:bg-gray-300 h-12 border-t-2 flex items-center justify-center text-sm",onClick:function(){return u(!0)},children:"Share to"}),(0,I.jsx)("button",{className:"w-full active:bg-gray-300 h-12 border-t-2 flex items-center justify-center text-sm",onClick:function(){navigator.clipboard.writeText(window.location.origin+f.Z.DASHBOARD+s.fromId+"/"+P.Z.POST+s.postId),t()},children:"Copy link"}),(0,I.jsx)("button",{className:"w-full active:bg-gray-300 h-12 border-t-2 flex items-center justify-center text-sm rounded-b-xl",onClick:t,children:"Cancel"})]}),i?(0,I.jsx)(v.Z,{closeEvent:function(){return u(!1)},styles:"h-[450px] top-[20%]",children:(0,I.jsx)(E.Z,{closeEvent:function(){return u(!1)},currentPost:s})}):null]})})),F=n.memo((function(e){var t=e.userInfo,s=e.post,r=(0,g.s0)(),l=(0,n.useState)(!1),o=(0,a.Z)(l,2),c=o[0],i=o[1];return(0,I.jsxs)("div",{className:"w-full flex justify-between border-b items-center",children:[t.userId.length?(0,I.jsxs)("button",{className:"h-14 py-[0.5px] gap-4 flex items-center px-3",onClick:function(){return r(f.Z.DASHBOARD+t.userId)},children:[(0,I.jsx)("img",{src:t.profileImage.length?t.profileImage:"/instagram-clone/images/default-avatar-image.jpg",className:"h-9 w-9 rounded-full object-cover"}),(0,I.jsx)("p",{className:"font-medium text-[14px] tracking-wide whitespace-nowrap",children:t.username})]}):(0,I.jsx)(d.Z,{imageStyles:{width:36,height:36,borderRadius:"50%"},firstTextStyles:{width:100,height:7,borderRadius:"10px"},secondTextStyles:{width:80,height:7,borderRadius:"10px"},margin:"my-1"}),(0,I.jsx)("button",{className:"mr-4",onClick:function(){return i(!0)},children:(0,I.jsx)(R.Z,{styles:"h-5 w-5"})}),c?(0,I.jsx)(v.Z,{closeEvent:function(){return i(!1)},styles:"top-[35%] h-60",children:(0,I.jsx)(T,{closeEvent:function(){return i(!1)},post:s})}):null]})})),O=n.memo((function(e){var t=e.currentPost,s=e.changePosts,r=(0,j.C)((function(e){return e.signedUser.user})),i=(0,n.useRef)(null),d=(0,n.useState)({username:"",profileImage:"",userId:""}),h=(0,a.Z)(d,2),g=h[0],w=h[1],v=(0,n.useState)(""),b=(0,a.Z)(v,2),y=b[0],N=b[1];(0,n.useEffect)((function(){var e=function(){var e=(0,c.Z)(u().mark((function e(){var s;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,x.QT)((0,x.JU)(m.db,"users",t.fromId));case 2:s=e.sent.data(),w((0,l.Z)({},s));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[]);var Z=(0,n.useCallback)((function(){return s((function(e){return e.map((function(e){return e.postId===t.postId?(0,l.Z)((0,l.Z)({},e),{},{likes:[].concat((0,o.Z)(e.likes),[{userId:r.userId}])}):e}))}))}),[t.postId,r.userId]),k=(0,n.useCallback)((function(){return s((function(e){return e.map((function(e){return e.postId===t.postId?(0,l.Z)((0,l.Z)({},e),{},{likes:e.likes.filter((function(e){return e.userId!==r.userId}))}):e}))}))}),[t.postId,r.userId]);return(0,I.jsxs)("article",{className:"w-full h-full flex flex-col bg-white border rounded-xl",children:[(0,I.jsx)(F,{userInfo:g,post:t}),(0,I.jsx)("div",{className:"w-full bg-black h-[400px] flex items-center justify-center",children:(0,I.jsx)("img",{src:t.postImage,className:"h-full w-full object-contain"})}),(0,I.jsx)(C.Z,{currentPost:t,commentsRef:i,changePostsAdd:Z,changePostsRemove:k}),(0,I.jsxs)("div",{className:"w-full flex flex-col px-3 items-start",children:[(0,I.jsxs)("p",{className:"break-words mx-1",children:[(0,I.jsx)(p.rU,{className:"font-medium text-sm",to:f.Z.DASHBOARD+g.userId,children:g.username}),(0,I.jsxs)("span",{className:"text-sm",children:[" ",t.text]})]}),(0,I.jsx)(p.rU,{className:"pl-1",to:f.Z.DASHBOARD+t.fromId+"/"+P.Z.POST+t.postId,children:(0,I.jsx)("p",{className:"text-sm text-gray-400 mt-1 tracking-wide",children:function(){var e=t.comments.length;return"View all ".concat(e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")," comment").concat(1===e?"":"s")}()})})]}),(0,I.jsx)(S.Z,{createdAt:t.createdAt}),(0,I.jsx)(A.Z,{postId:t.postId,wordEntering:y,setWordEntering:N,commentsRef:i,currentPostFromId:t.fromId})]})})),D=O,U=n.memo((function(){var e=(0,j.C)((function(e){return e.signedUser.user})),t=(0,k.Z)(),s=(0,n.useState)(null),r=(0,a.Z)(s,2),l=r[0],o=r[1];(0,n.useEffect)((function(){var t=function(){var t=(0,c.Z)(u().mark((function t(){var s,n,r,l,c,a;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=(0,x.hJ)(m.db,"users"),n=(0,x.IO)(s,(0,x.ar)("userId","in",e.following.map((function(e){return e.userId})))),t.next=4,(0,x.PL)(n);case 4:r=t.sent,l=r.docs.map((function(e){return e.data()})),c=l.reduce((function(e,t){return t.posts.forEach((function(t){return e.push(t)})),e}),[]),a=c.sort((function(e,t){return t.createdAt-e.createdAt})).slice(0,20),console.log(a),o(a);case 10:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();e.following.length?t():o([])}),[]);var i=(0,n.useMemo)((function(){return null===l||void 0===l?void 0:l.map((function(e){return(0,I.jsx)(D,{currentPost:e,changePosts:o},e.postId+e.fromId)}))}),[l]);return(0,I.jsx)("div",{className:"flex ".concat(null!==l&&0===l.length?"hidden":""),children:l?(0,I.jsx)("div",{children:(0,I.jsxs)("div",{className:"flex flex-col items-center gap-4 ".concat(t>500?"w-[470px]":"w-full"),children:[i,(0,I.jsxs)("div",{className:"w-full flex flex-col items-center mt-8 mb-14",children:[(0,I.jsx)("img",{src:"/instagram-clone/images/done.jpg",className:"w-16"}),(0,I.jsx)("p",{className:"text-lg",children:"You're all caught up"}),(0,I.jsx)("p",{className:"text-sm text-gray-400",children:"You've seen all new posts from the past days"})]})]})}):(0,I.jsx)("div",{className:"h-32 ".concat(t>500?"w-[470px]":"w-full"," flex items-center justify-center"),children:(0,I.jsx)("div",{style:{borderTopColor:"transparent"},className:"w-16 h-16 border-4 border-gray-700 border-dashed rounded-full animate-spin"})})})})),M=U,B=n.memo((function(){(0,j.C)((function(e){return e.signedUser.user}));var e=(0,k.Z)();return m.I8.currentUser?(0,I.jsxs)("div",{className:"bg-[#f7f7f7] overflow-hidden overflow-y-auto flex flex-col items-center",children:[(0,I.jsx)(r.Z,{}),(0,I.jsxs)("div",{className:"min-h-[calc(100vh-60px)] w-[100%] flex justify-center bg-[#f7f7f7] pt-6 gap-6",children:[(0,I.jsx)(M,{}),e>950?(0,I.jsx)(Z,{}):null]})]}):(0,I.jsx)(g.Fg,{to:f.Z.LOGIN})}))},4140:function(e,t,s){s(2791);var n=s(184);t.Z=function(e){var t=e.styles;return(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"})})}}}]);
//# sourceMappingURL=512.a070596d.chunk.js.map