"use strict";(self.webpackChunkinstagram_clone=self.webpackChunkinstagram_clone||[]).push([[142],{4142:function(e,t,r){r.r(t),r.d(t,{default:function(){return S}});var s=r(885),n=r(2791),a=r(6871),c=r(2982),u=r(5861),l=r(7757),i=r.n(l),o=r(213),d=r(1743),f=r(4874),x=r(417),m=r(5910),h=r(184),p=n.memo((function(e){var t=e.closeEvent,r=(0,d.C)((function(e){return e.signedUser.user})),a=(0,n.useState)(""),l=(0,s.Z)(a,2),p=l[0],g=l[1],j=(0,n.useState)([]),w=(0,s.Z)(j,2),v=w[0],I=w[1],b=(0,n.useState)([]),N=(0,s.Z)(b,2),y=N[0],U=N[1],k=(0,m.Z)().createChatRoom,Z=(0,n.useRef)(null);(0,n.useEffect)((function(){var e=setTimeout((0,u.Z)(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,o.Z)(p,U);case 2:U((function(e){return e.filter((function(e){return e.username!==r.username}))}));case 3:case"end":return e.stop()}}),e)}))),300);return function(){return clearTimeout(e)}}),[p]);var C=(0,n.useMemo)((function(){return v.map((function(e){return(0,h.jsx)("div",{className:"bg-blue-100 flex rounded p-2",children:(0,h.jsxs)("button",{className:"flex gap-1",onClick:function(){return function(e){I((function(t){return t.filter((function(t){return t.username!==e.username}))})),null!==Z.current&&Z.current.focus()}(e)},children:[(0,h.jsx)("p",{className:"text-cyan-500 text-sm ",children:e.username}),(0,h.jsx)(f.Z,{styles:"w-5 h-5 text-cyan-500"})]})},e.userId)}))}),[v,Z]),E=(0,n.useMemo)((function(){return y.map((function(e){return(0,h.jsx)(x.Z,{addUserToList:function(){return function(e){I((function(t){return[].concat((0,c.Z)(t),[e])})),g(""),null!==Z.current&&Z.current.focus()}(e)},removeUserFromList:function(){return function(e){I((function(t){return t.filter((function(t){return t.username!==e.username}))})),null!==Z.current&&Z.current.focus()}(e)},isUserInList:v.some((function(t){return t.username===e.username})),profileImage:e.profileImage,username:e.username,fullName:e.fullName,userId:e.userId},e.userId)}))}),[y,v]);return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)("div",{className:"h-11 w-full flex justify-center items-center font-medium border-b relative ",children:[(0,h.jsx)("button",{className:"absolute left-2",onClick:t,children:(0,h.jsx)(f.Z,{styles:"w-7 h-7"})}),(0,h.jsx)("p",{children:"New message"}),(0,h.jsx)("button",{className:"absolute right-3 font-bold ".concat(0===v.length?"text-blue-300":"text-blue-500"),disabled:0===v.length,onClick:function(){return k({chosenUserId:v[0].userId,closeEvent:t})},children:(0,h.jsx)("p",{children:"Next"})})]}),(0,h.jsxs)("div",{className:"w-full max-h-[175px] flex border-b p-3 items-start gap-5",children:[(0,h.jsx)("p",{className:"font-medium mt-[6px]",children:"To:"}),(0,h.jsxs)("div",{className:"w-full h-full flex flex-col items-start gap-2 overflow-hidden overflow-y-auto",children:[C,(0,h.jsx)("input",{className:"w-full p-2 rounded-lg placeholder:font-light placeholder:text-gray-400 placeholder:text-sm relative text-sm",type:"text",placeholder:"Search...",value:p,onChange:function(e){return g(e.target.value)},ref:Z})]})]}),(0,h.jsx)("div",{className:"flex flex-col overflow-hidden overflow-y-auto",children:y.length?E:(0,h.jsx)("p",{className:"font-medium text-sm pl-3 mt-2",children:"No Suggested"})})]})})),g=n.memo((function(e){var t=e.openModal;return(0,h.jsxs)("div",{className:"w-full h-full flex flex-col justify-center items-center gap-1",children:[(0,h.jsx)("img",{src:"/instagram-clone/images/direct.jpg",className:"w-[120px] h-[112px]",alt:"direct"}),(0,h.jsx)("p",{className:"text-2xl font-thin",children:"Your Messages"}),(0,h.jsx)("p",{className:"text-gray-400 text-sm",children:"Send private photos and messages to a friend or group."}),(0,h.jsx)("button",{className:"h-[30px] w-[115px] mt-5 bg-blue-500 font-medium text-white rounded cursor-pointer text-sm tracking-wide flex items-center justify-center",onClick:t,children:"Send Message"})]})})),j=r(6724),w=r(83),v=r(9329),I=function(){return(0,h.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-[26px] w-[26px] text-gray-800",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:(0,h.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})},b=r(522),N=n.memo((function(e){var t=e.userId,r=e.chatId,c=e.lastMessage,l=e.lastEdited,o=(0,a.s0)(),d=(0,a.UO)().chatId,f=(0,n.useState)({profileImage:"",username:""}),x=(0,s.Z)(f,2),m=x[0],p=x[1];(0,n.useEffect)((function(){var e=function(){var e=(0,u.Z)(i().mark((function e(){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,j.QT)((0,j.JU)(v.db,"users",t));case 2:r=e.sent,p({profileImage:r.data().profileImage,username:r.data().username});case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[]);return(0,h.jsx)("button",{className:"flex h-20 px-2 pr-6 items-center justify-center py-1 ".concat(d===r&&"back"),onClick:function(){return o(w.Z.DIRECT+"/"+r)},children:(0,h.jsxs)("div",{className:"w-full h-16 py-[0.5px] gap-4 flex items-center px-3",children:[(0,h.jsx)("img",{src:m.profileImage.length?m.profileImage:"/instagram-clone/images/default-avatar-gray.jpg",className:"h-[60px] w-[60px] rounded-full object-cover"}),(0,h.jsxs)("div",{className:"flex flex-col justify-center text-left w-full",children:[(0,h.jsx)("p",{className:"w-[165px] truncate text-sm tracking-wide",children:m.username}),(0,h.jsxs)("div",{className:"flex gap-1",children:[(0,h.jsx)("p",{className:"font-medium text-sm tracking-wide whitespace-nowrap",children:"".concat(c.userId!==t&&c.text.length?"You:":" ")}),(0,h.jsx)("p",{className:"max-w-[125px] truncate text-gray-400 text-sm",children:c.text}),0!==c.userId.length?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("p",{className:"text-sm text-gray-400",children:"\u2022"}),(0,h.jsx)("p",{className:"text-sm text-gray-400",children:function(){var e=(0,b.Z)(l);return"Now"===e?e:e.split(" ")[0]+e.split(" ")[1][0]}()})]}):null]})]})]})})})),y=N,U=r(9688),k=n.memo((function(e){var t=e.openModal,r=(0,d.C)((function(e){return e.signedUser.user})),c=(0,a.s0)(),l=(0,a.UO)().chatId,o=(0,n.useState)([]),f=(0,s.Z)(o,2),x=f[0],m=f[1];(0,n.useEffect)((function(){var e=function(){var e=(0,u.Z)(i().mark((function e(){var t,s,n,a,c,u,l;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,j.hJ)(v.db,"chats"),s=(0,j.IO)(t,(0,j.ar)("firstUserId","==",r.userId)),n=(0,j.IO)(t,(0,j.ar)("secondUserId","==",r.userId)),e.next=5,(0,j.PL)(s);case 5:return a=e.sent,e.next=8,(0,j.PL)(n);case 8:c=e.sent,u=a.docs.map((function(e){return e.data()})).concat(c.docs.map((function(e){return e.data()}))),l=u.map((function(e){return{firstUserId:e.firstUserId,secondUserId:e.secondUserId,messages:e.messsages,lastMessage:e.lastMessage,lastEdited:e.lastEdited}})),m(l.sort((function(e,t){return t.lastEdited-e.lastEdited})));case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,j.cf)((0,j.IO)((0,j.hJ)(v.db,"chats"),(0,j.ar)("firstUserId","==",r.userId)),(0,u.Z)(i().mark((function t(){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e();case 2:case"end":return t.stop()}}),t)})))),(0,j.cf)((0,j.IO)((0,j.hJ)(v.db,"chats"),(0,j.ar)("secondUserId","==",r.userId)),(0,u.Z)(i().mark((function t(){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e();case 2:case"end":return t.stop()}}),t)}))))}),[r.userId,l]);var p=(0,n.useMemo)((function(){return x.map((function(e){return(0,h.jsx)(y,{chatId:e.firstUserId+"-"+e.secondUserId,userId:r.userId===e.firstUserId?e.secondUserId:e.firstUserId,lastMessage:e.lastMessage,lastEdited:e.lastEdited},r.userId===e.firstUserId?e.secondUserId:e.firstUserId)}))}),[x,r.userId]);return(0,h.jsxs)("aside",{className:"w-full sm:w-[520px] h-full border-r flex flex-col",children:[(0,h.jsxs)("div",{className:"flex justify-end items-center h-[60px] border-b pr-4",children:[(0,h.jsx)("div",{className:"w-full flex justify-center pl-4",children:(0,h.jsx)("button",{className:"font-medium",onClick:function(){return c(w.Z.DIRECT)},children:(0,h.jsxs)("p",{children:["@",r.username]})})}),(0,h.jsx)("button",{onClick:t,children:(0,h.jsx)(I,{})})]}),(0,h.jsx)("nav",{className:"flex flex-col w-full h-[calc(100%-60px)] overflow-hidden overflow-y-auto",children:x.length?p:function(){for(var e=[],t=0;t<3;t++)e.push((0,h.jsx)(U.Z,{imageStyles:{width:60,height:60,borderRadius:"50%"},firstTextStyles:{width:180,height:11,borderRadius:"10px"},secondTextStyles:{width:150,height:11,borderRadius:"10px"},margin:"my-1"},t));return e}()})]})})),Z=k,C=r(4968),E=r(1273),M=r(7018),S=n.memo((function(){var e=(0,a.UO)().chatId,t=(0,n.useState)(!1),r=(0,s.Z)(t,2),c=r[0],u=r[1],l=(0,M.Z)();return(0,h.jsxs)("div",{className:"back w-screen h-screen flex flex-col items-center ",children:[(0,h.jsx)(C.Z,{}),(0,h.jsxs)("section",{className:"flex flex-col sm:flex-row gap-16 sm:gap-0 bg-white w-full md:w-11/12 lg:w-4/5 xl:w-2/3 h-[calc(100vh-90px)] max-w-[935px] border-x border-b border-t my-3",children:[l>640?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(Z,{openModal:function(){return u(!0)}}),e?(0,h.jsx)(a.j3,{}):(0,h.jsx)(g,{openModal:function(){return u(!0)}})]}):e?(0,h.jsx)(a.j3,{}):(0,h.jsx)(Z,{openModal:function(){return u(!0)}}),c?(0,h.jsx)(E.Z,{closeEvent:function(){return u(!1)},styles:"h-[450px] top-[20%]",children:(0,h.jsx)(p,{closeEvent:function(){return u(!1)}})}):null]})]})}))}}]);
//# sourceMappingURL=142.95970429.chunk.js.map